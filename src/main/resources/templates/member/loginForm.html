<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>로그인</title>
    <link rel="stylesheet" href="/css/member/loginForm.css">
<!--    <script src="/js/auth-handler.js"></script>-->
    <link rel="icon" href="/images/favicon.ico">
</head>
<body>
<form id="loginForm" class="login-form">
    <h2>로그인</h2>

    <div class="form-group">
        <label for="userId">아이디:</label>
        <input type="text" id="userId" name="userId" required>
    </div>

    <div class="form-group">
        <label for="password">비밀번호:</label>
        <input type="password" id="password" name="password" required>
    </div>

    <button type="submit">로그인</button>

    <!-- 소셜 로그인 버튼 추가 -->
    <div class="oauth-login">
        <a th:href="@{/oauth2/authorization/naver}" class="naver">
            <img src="https://static.nid.naver.com/oauth/button_g.PNG" height="50">
        </a>
    </div>

    <div class="signup-link">
        <a th:href="@{/signup}">회원가입</a>
    </div>
</form>

<script>
    document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();

        const userId = document.getElementById('userId').value;
        const password = document.getElementById('password').value;

        fetch('/api/auth/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ userId, password }),
        })
            .then(response => {
                if (response.ok) {
                    return response.json();
                }
                throw new Error('Login failed');
            })
            .then(data => {
                console.log('Login successful', data);
                // 로그인 성공 시 처리 (예: 홈페이지로 리다이렉트)
                window.location.href = '/';
            })
            .catch(error => {
                console.error('Login error:', error);
                // 로그인 실패 시 처리 (예: 에러 메시지 표시)
                alert('로그인에 실패했습니다. 아이디와 비밀번호를 확인해주세요.');
            });
    });
</script>
</body>
</html>